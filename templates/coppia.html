{% extends "base.html" %}

{% block title %}Statistiche di Coppia{% endblock %}

{% block content %}
  <h2 class="text-2xl font-bold mb-6 text-center">Statistiche di Coppia</h2>

  <!-- Form scelta giocatori -->
  <form method="get" action="/coppia" class="bg-white shadow-md rounded-lg p-6 mb-8 flex flex-col md:flex-row items-center gap-4 justify-center">
    <div>
      <label for="g1" class="block text-sm font-semibold text-gray-700 mb-1">Giocatore 1</label>
      <select name="g1" id="g1" class="w-48 border-gray-300 rounded-lg shadow-sm focus:ring focus:ring-blue-200">
        {% for g in giocatori %}
          <option value="{{ g }}" {% if g == g1 %}selected{% endif %}>{{ g }}</option>
        {% endfor %}
      </select>
    </div>

    <div>
      <label for="g2" class="block text-sm font-semibold text-gray-700 mb-1">Giocatore 2</label>
      <select name="g2" id="g2" class="w-48 border-gray-300 rounded-lg shadow-sm focus:ring focus:ring-blue-200">
        {% for g in giocatori %}
          <option value="{{ g }}" {% if g == g2 %}selected{% endif %}>{{ g }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="mt-4 md:mt-6">
      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-lg shadow">
        Mostra statistiche
      </button>
    </div>
  </form>

  {% if stats %}
    <h3 class="text-xl font-bold mb-4 text-center">Risultati per {{ stats.giocatore1 }} + {{ stats.giocatore2 }}</h3>

    <!-- Statistiche insieme -->
    <div class="grid md:grid-cols-2 gap-6 mb-6">
      <div class="bg-white shadow rounded-lg p-4">
        <ul class="space-y-2 text-gray-700">
          <li><span class="font-semibold">Partite giocate insieme:</span> {{ stats.partite_insieme }}</li>
          <li><span class="font-semibold">Vittorie insieme:</span> {{ stats.vittorie }} ({{ stats.percentuale_vittorie }}%)</li>
          <li><span class="font-semibold">Media Gol di {{ stats.giocatore1 }}:</span> {{ stats.media_gol_insieme[0] }}</li>
          <li><span class="font-semibold">Media Gol di {{ stats.giocatore2 }}:</span> {{ stats.media_gol_insieme[1] }}</li>
        </ul>
      </div>

      <!-- Confronto senza l'altro -->
      <div class="bg-white shadow rounded-lg p-4">
        <h4 class="text-lg font-semibold mb-2">Confronto senza l’altro</h4>
        <ul class="space-y-2 text-gray-700">
          <li>
            <span class="font-semibold">{{ stats.giocatore1 }}</span> senza {{ stats.giocatore2 }}: 
            Vittorie {{ stats.stats_no_insieme1[0] }}%, Media Gol {{ stats.stats_no_insieme1[1] }}
          </li>
          <li>
            <span class="font-semibold">{{ stats.giocatore2 }}</span> senza {{ stats.giocatore1 }}: 
            Vittorie {{ stats.stats_no_insieme2[0] }}%, Media Gol {{ stats.stats_no_insieme2[1] }}
          </li>
        </ul>
      </div>
    </div>

  {% elif g1 and g2 %}
    <p class="text-center text-gray-500">⚠️ Nessuna partita trovata per questa coppia.</p>
  {% endif %}
{% endblock %}
